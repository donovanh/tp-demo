<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="./stylesheets/styleguide.css">
    <link rel="stylesheet" href="./stylesheets/main.css">

    <script src="./javascripts/head.min.js"></script>

    <script>
    window.translationsLoaded = false;
    //window.templatesDone = false;

    // Using i18next for 118n https://www.i18next.com
    i18next.use(i18nextXHRBackend);
    i18next.init({
      'debug': true,
      'lng': 'en',
      'fallbackLng': 'en',
      backend: {
        loadPath: '/locales/{{lng}}.json'
      }
    }, function() {
      jqueryI18next.init(i18next, $, {
        optionsAttr: 'i18n-options',
        useOptionsAttr: true
      });
      window.translationsLoaded = true;
    });

    </script>

    <script id="section-template" type="text/html">
      <section class="section {{bgClass}}">
        <h2 class="section-title" data-i18n="{{i18n.title}}">{{title}}</h2>
        <div class="section-content">
          {{{ content }}}
        </div>
      </section>
    </script>

    <script id="asset-template" type="text/html">
      <div class="asset {{class}}">
        {{#i18n.locale}}
          <span class="image" style="background-image: url({{image}}{{i18n.locale}}@4x.jpg)"></span>
        {{/i18n.locale}}
        {{^i18n.locale}}
          <span class="image" style="background-image: url({{image}})"></span>
        {{/i18n.locale}}
        {{#i18n.title}}
          <h2 class="asset-title" data-i18n="{{i18n.title}}">{{title}}</h2>
        {{/i18n.title}}
        {{^i18n.title}}
          <h2 class="asset-title">{{title}}</h2>
        {{/i18n.title}}
      </div>
    </script>

    <script id="bundle-template" type="text/html">
      <div class="asset bundle {{class}}">
        {{#i18n.locale}}
          <span class="image" style="background-image: url({{image}}{{i18n.locale}}@4x.jpg)"></span>
        {{/i18n.locale}}
        {{^i18n.locale}}
          <span class="image" style="background-image: url({{image}})"></span>
        {{/i18n.locale}}
        <h2 class="asset-title">{{title}}</h2>
        <p class="asset-pricing">
          <span class="asset-number-of-apps">
            {{numberOfApps}} 
            <span data-i18n="app" data-i18n-options='{ "count": {{numberOfApps}} }'>apps</span>
          </span>
          <span class="asset-price">
            <span data-i18n="currencySymbol">$</span>
            {{price}}
          </span>
        </p>
        {{#childImage}}
          <span class="child-image" style="background-image: url({{childImage}})"></span>
        {{/childImage}}
      </div>
    </script>

    <script>
      function rendertoHTML(template, settings) {
        return Mustache.render(template, settings);
      }
      function renderArrayToHTML(template, items) {
        var html = '';
        $(items).each(function(index, item) {
          html += rendertoHTML(template, item);
        });
        return html;
      }
      function render(template, settings, selector) {
        var html = Mustache.render(template, settings);
        $(selector).html(html);
      }
    </script>
  </head>
<script>
/*
Notes
- Set up a general-purpose "renderTemplate" helper function
- Define the template (inline for now)
- Move the templates into the templates folder and load them into variables to use
- Define each component as a set of JS settings, including template name
- Render each template
- Include instructions for usage

Components
- Sections - solid background / not
- Section title
- App icons
- Block assets
-- Asset title
-- Brick
-- Book
-- Icon
-- Bundle

- Modifications
-- Free / New badge
-- Animated background
-- Other animation types

- Show-on-scroll animations
-- Play-once
-- Play each time

- Visual themes
-- Custom border / shadow shapes per theme
-- Custom animations to match theme
*/
</script>
  <body>
    
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h1>Components</h1>
          <article class="sections">
            <h2>Sections</h2>

            <div class="example">
              <div id="section-1"></div>
              <script>
                var settings = {
                  bgClass: 'bg-white',
                  title: 'White background section',
                  content: '',
                  i18n: {
                    title: 'section1Title'
                  }
                }
                var template = $('#section-template').html();
                render(template, settings, '#section-1');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  bgClass: 'bg-white',
  title: 'Placeholder text',
  content: '',
  i18n: {
    title: 'section1Title'
  }
}
var template = $('#section-template').html();
render(template, settings, '#section-1');
</code></pre>
                </div>
              </div>
            </div>

            <div class="example">
              <div id="section-2"></div>
              <script>
                var settings = {
                  bgClass: 'bg-none',
                  title: 'Transparent background section',
                  content: '',
                  i18n: {
                    title: 'section2Title'
                  }
                }
                var template = $('#section-template').html();
                render(template, settings, '#section-2');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  bgClass: 'bg-none',
  title: 'Placeholder text',
  content: '',
  i18n: {
    title: 'section2Title'
  }
}
var template = $('#section-template').html();
render(template, settings, '#section-2');
</code></pre>
                </div>
              </div>
            </div>

          </article>

          <article class="assets">
            <h2>Assets</h2>

            <div class="example">
              <div id="asset-1"></div>
              <script>
                var settings = {
                  class: 'brick',
                  title: 'Example brick',
                  image: './images/bricks/mgc_brick_',
                  i18n: {
                    locale: 'en',
                    title: 'asset1Title'
                  }
                }
                var template = $('#asset-template').html();
                render(template, settings, '#asset-1');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  class: 'brick',
  title: 'Example brick',
  image: './images/bricks/mgc_brick_',
  i18n: {
    locale: 'en',
    title: 'asset1Title'
  }
}
var template = $('#asset-template').html();
render(template, settings, '#asset-1');
</code></pre>
                </div>
              </div>
            </div>

            <div class="example">
              <div id="asset-2"></div>
              <script>
                var settings = {
                  class: 'book',
                  title: 'Placeholder text',
                  image: '"./images/icons/Apps/ST/Dino Dog.jpg"',
                  // If image cannot be localised, leave off the i18n.locale part
                  i18n: {
                    //locale: 'en',
                    title: 'asset2Title'
                  }
                }
                var template = $('#asset-template').html();
                render(template, settings, '#asset-2');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  class: 'book',
  title: 'Placeholder text',
  image: './images/...jpg',
  // If image cannot be localised, leave off the i18n.locale part
  i18n: {
    //locale: 'en',
    title: 'asset2Title'
  }
}
var template = $('#asset-template').html();
render(template, settings, '#asset-2');
</code></pre>
                </div>
              </div>
            </div>

            <div class="example">
              <div id="asset-3"></div>
              <script>
                var settings = {
                  class: 'icon',
                  title: 'Example icon',
                  image: '"./images/icons/Apps/ST/Dino Dog.jpg"',
                  i18n: {
                    title: 'asset3Title'
                  }
                }
                var template = $('#asset-template').html();
                render(template, settings, '#asset-3');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  class: 'icon',
  title: 'Example icon',
  image: './images/...jpg',
  i18n: {
    title: 'asset3Title'
  }
}
var template = $('#asset-template').html();
render(template, settings, '#asset-3');
</code></pre>
                </div>
              </div>
            </div>

            <div class="example">
              <div id="asset-4"></div>
              <script>
                var settings = {
                  class: 'bundle no-child',
                  title: 'Example bundle',
                  image: './images/bricks/mgc_brick_',
                  numberOfApps: 4,
                  price: '0.99',
                  i18n: {
                    locale: 'en',
                    title: 'asset4Title'
                  }

                }
                var template = $('#bundle-template').html();
                render(template, settings, '#asset-4');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  class: 'bundle no-child',
  title: 'Example bundle',
  image: './images/bricks/mgc_brick_en@4x.jpg',
  numberOfApps: 4,
  price: '0.99',
  i18n: {
    locale: 'en',
    title: 'asset4Title'
  }
}
var template = $('#bundle-template').html();
render(template, settings, '#asset-4');
</code></pre>
                </div>
              </div>
            </div>

            <div class="example">
              <div id="asset-5"></div>
              <script>
                var settings = {
                  class: 'bundle with-child',
                  title: 'Example bundle',
                  image: './images/bricks/mgc_brick_',
                  childImage: '"./images/icons/Apps/ST/Dino Dog.jpg"',
                  numberOfApps: 4,
                  price: '0.99',
                  i18n: {
                    locale: 'en',
                    title: 'asset5Title'
                  }
                }
                var template = $('#bundle-template').html();
                render(template, settings, '#asset-5');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var settings = {
  class: 'bundle with-child',
  title: 'Example bundle',
  image: './images/bricks/mgc_brick_en@4x.jpg',
  childImage: './images/icons/Apps/ST/Dino Dog.jpg',
  numberOfApps: 4,
  price: '0.99',
  i18n: {
    title: 'asset5Title'
  }
}
var template = $('#bundle-template').html();
render(template, settings, '#asset-5');
</code></pre>
                </div>
              </div>
            </div>

          </article>

          <article class="assets-in-sections">
            <h2>Assets in sections</h2>

            <div class="example">
              <div id="mixed-1"></div>
              <script>
                var assets = [
                  {
                    class: 'icon',
                    title: 'Example icon',
                    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
                  },
                  {
                    class: 'icon',
                    title: 'Example icon',
                    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
                  },
                  {
                    class: 'icon',
                    title: 'Example icon',
                    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
                  },
                  {
                    class: 'icon',
                    title: 'Example icon',
                    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
                  },
                  {
                    class: 'icon',
                    title: 'Example icon',
                    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
                  }
                ]
                var template = $('#asset-template').html();
                var assetHTML = renderArrayToHTML(template, assets);

                var settings = {
                  bgClass: 'bg-white',
                  title: 'Section containing assets',
                  content: assetHTML,
                  i18n: {
                    title: 'section3Title'
                  }
                }
                var template = $('#section-template').html();
                render(template, settings, '#mixed-1');
              </script>
              <div class="example-description">
                <h3 class="toggle-usage">Usage</h3>
                <div class="usage hidden">
<pre><code>var assets = [
  {
    class: 'icon',
    title: 'Example icon',
    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
  },
  {
    class: 'icon',
    title: 'Example icon',
    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
  },
  {
    class: 'icon',
    title: 'Example icon',
    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
  },
  {
    class: 'icon',
    title: 'Example icon',
    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
  },
  {
    class: 'icon',
    title: 'Example icon',
    image: '"./images/icons/Apps/ST/Dino Dog.jpg"'
  }
]
var template = $('#asset-template').html();
var assetHTML = renderArrayToHTML(template, assets);

var settings = {
  bgClass: 'bg-white',
  title: 'Example with icons',
  content: assetHTML
}
var template = $('#section-template').html();
render(template, settings, '#mixed-1');
</code></pre>
                </div>
              </div>
            </div>

          </article>
        </div>
      </div>
    </div>

    <script>
      // Styleguide logic - don't include in the final index 
      $('.toggle-usage').click(function() {
        $(this).toggleClass('hide');
        $(this).parent().find('.usage').toggleClass('hidden');
      });

      // Lastly, run the localization on the page content
      // Use requestAnimationFrame to poll until page is ready to be localised
      var check = window.requestAnimationFrame;
      function poll() {
        if (window.translationsLoaded) {
          $('body').localize();
        } else {
          check(poll);
        }
      }
      // Call the poll for the first time
      poll();
    </script>
  </body>
</html>

